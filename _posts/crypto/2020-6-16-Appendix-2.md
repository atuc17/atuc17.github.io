---
layout: post
title: Phụ lục 2 - Số học modulo và số học đa thức
categories: [cryptography]
---
## I. Số học modulo - Trường hữu hạn GF(p)
Ta xây dựng tập $$\mathbb{Z}_n$$ như sau: cho số nguyên n, $$\mathbb{Z}_n = {0, 1, ..., n}$$. Như vậy $$\forall a, b \in \mathbb{Z}$$ ta có:

- Phép cộng: $$c = (a+b)$$ nếu $$c \equiv a+b \; mod \; n$$
- Phép nhân: $$c = ab$$ nếu $$c \equiv ab \; mod \; n$$

Tính chất:
- Là nhóm Abel với phần tử đơn vị của phép cộng là 0
- Là miền nguyên với phần tử đơn vị của phép nhân là 1

Tuy nhiên, không phải tập $$\mathbb{Z}_n$$ nào cũng thỏa m7 (tồn tại nghịch đảo của phép nhân). Ví dụ với n=6 và a=2 thì không có số b nào mà ab=1 (mod 6). Chỉ khi n là số nguyên tố thì $$\mathbb{Z}_n$$ mới thỏa m7.

Khi đó, $$\mathbb{Z}_p$$ với p là số nguyên tố cùng với phép cộng và phép nhân modulo p là 1 trường. Người ta hay gọi trường này là trường Galois (nhà toán học trẻ tuổi bạc mệnh mà mình rất thích) và ký hiệu trường này là GF(p). Trong nhiều sách người ta cũng ký hiệu $$\mathbb{F}_p$$ để chỉ trường này.

## II. Số học đa thức - Trường hữu hạn GF(2<sup>n</sup>)
### 1. Đa thức thông thường:

Một đa thức bậc $$n \geq 0$$: 
$$\begin{align*}
f(x) = a_nx^n + a_{n-1}x^{n-1}+.....+a_2x^2+a_1x+a_0
= \sum_0^n a_ix^i (a_i \in \mathbb{R}, i = \overline{0, n})\end{align*}$$

Phép cộng và phép nhân trong đa thức thông thường tạo thành 1 *vành*, với phần tử đơn vị là đa thức e(x)=0, phần tử đơn vị của phép nhân là đa thức d(x)=1. 

*Tuy nhiên*, tập các đa thức trên không tạo thành trường vì không tồn tại phần tử nghịch đảo của phép nhân (dễ thấy với đa thức f(x) bất kì, không thể tìm được đa thức g(x) để f(x)*g(x)=1)

### 2. Đa thức trên tập $$\mathbb{Z}_p$$
Xét tập đa thức $$W_p = \{f(x) = \sum_0^n a_ix^i \quad với \quad n \geq 0, a_i \in \mathbb{Z}_p, a_n \neq 0\}$$

Trên tập $$\mathbb{Z}_p$$ ta định nghĩa các phép cộng, trừ, nhân, chia như sau:

Với 2 đa thức $$f(x) = \sum_0^n a_ix^i; g(x) = \sum_0^m b_ix^i$$

- *Phép cộng*: $$f(x)+g(x) = \sum_0^{max(m, n)} (a_i+b_i)x^i$$. Ở đây các hệ số f(x) của số hạng bậc lớn hơn n bằng 0, hệ số g(x) cũng tương tự.

- *Phép trừ*: $$f(x)-g(x) = \sum_0^{max(m, n)} (a_i-b_i)x^i$$.

- *Phép nhân*: $$f(x).g(x) = \sum_0^{m+n} c_ix^i \quad với \quad c_k = a_0b_k+a_1b_{k-1}+....+a_{k-1}b_1+a_kb_0$$

- *Phép chia*: $$f(x)/g(x)$$: thương là đa thức $$q(x)$$ và dư là đa thức $$r(x)$$.

Các phép toán $$a_i+b_i$$, $$a_i-b_i$$, $$a_i \times b_i$$, $$a_i/b_i$$ được định nghĩa trong $$\mathbb{Z}_p$$

**Ví dụ**: Xét trường $$\mathbb{Z}_2 = {0, 1}$$ và 2 đa thức $$f(x) = x^5+x^2+x+1$$ và $$g(x) = x^2+1$$ thì:

$$\begin{align*}
f(x)+g(x) = x^5+x \\
f(x)-g(x)=x^5+x \\
f(x) \times g(x) = x^7+x^5+x^4+x^3+x+1 \\
f(x) / g(x): \; q(x)=x^3+x+1, r(x)=0
\end{align*}$$

$$f(x)$$ được gọi là đa thức **không tối giản** vì chia hết cho $$g(x)$$ (tương tự hợp số trong các số tự nhiên).

Khi 1 đa thức không chia hết bất kì đa thức nào, đa thức đó gọi là **tối giản** (tương tự số nguyên tố).

### 3. Phép modulo đa thức
Giả sử ta có 2 đa thức $$f(x)$$ và $$m(x)$$, phép chia modulo $$r(x) = f(x) \; mod \; m(x)$$ là phần dư của phép chia $$f(x)/m(x)$$

Như ví dụ trên, $$r(x) = 0$$

### 4. Trường hữu hạn GF(2<sup>n</sup>)
Tương tự $$\mathbb{Z}_p$$, ta xây dựng tập $$W_{pm}$$ các đa thức dùng phép modulo đa thức.

- Chọn 1 đa thức $$m(x)$$ tối giản trên $$\mathbb{Z}_p$$ có bậc là n

- Tập $$W_{pm}$$ gồm các đa thức trên $$\mathbb{Z}_p$$ có bậc nhỏ hơn n. Nghĩa là $$f(x) \in W_{pm}$$ có dạng

$$f(x) = \sum_0^{n-1} a_ix^i \quad với \quad a_i \in \mathbb{Z}_p = \{0, 1, ....., p-1\}$$

Đa thức có n số hạng, mỗi số hạng có hệ số từ 0 tới p-1 (p trường hợp). Theo quy tắc nhân thì $$W_{pm}$$ có p<sup>n</sup> phần tử.

**Ví dụ**:
- p = 3, n = 2: $$W_{pm} = \{0, 1, 2, x, x+1, x+2, 2x, 2x+1, 2x+2\}$$
- p = 2, n = 3: $$W_{pm} = \{0, 1, x, x+1, x^2, x^2+1, x^2+x, x^2+x+1\}$$

Do $$m(x)$$ là đa thức tối giản nên các phần tử trong $$W_{pm}$$ đều tồn tại nghịch đảo của phép nhân.

$$\forall f(x) \in W_{pm}, \exists f^{-1}(x) \in W_{pm}: f(x) \times f^{-1}(x) = 1 mod m(x)$$

Từ đó ta có phép chia: $$f(x)/g(x) = f(x) \times g^{-1}(x)$$

Lúc này $$W_{pm}$$ thỏa mãn các tính chất của trường hữu hạn và ta ký hiệu là $$GF(p^n)$$ (cũng theo tên nhà toán học Galois). Trong mã hóa ta chỉ quan tâm tới p=2 tức là trường hữu hạn $$GF(2^n)$$ trên tập $$\mathbb{Z}_2$$.